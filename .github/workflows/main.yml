name: Notification on push

on:
  push:
    branches:
    - master
    - main # ‚úäüèø
    - speed

env:
  CI: true
  SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK }}
  HUSKY_SKIP_INSTALL: true

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2

    - name: Check syntax
      run: |
        yarn install --frozen-lockfile --silent --non-interactive
        yarn lint

    - name: Slack notification FAILED
      uses: itsmelion/action-slack@speed
      if: failure()
      env:
        SLACK_AVATAR: sender # optional: repository, sender or ImageURL
      with:
        args: "Lint checks *FAILED* for {{GITHUB_REPOSITORY}}*\nYo {{GITHUB_ACTOR}} see why at <{{GITHUB_SERVER_URL}}/{{GITHUB_REPOSITORY}}/commit/{{GITHUB_SHA}}/checks|action logs>"

    - name: Slack notification SUCCESS
      uses: itsmelion/action-slack@speed
      if: success()
      with:
        args: "Lint checks *SUCCESSFUL!*\nfrom {{ GITHUB_ACTOR }} at {{ GITHUB_REPOSITORY }}"
